---
phase: 05-oauth-integration
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - frontend/src/components/auth/LoginModal.tsx
  - frontend/src/components/auth/SignupModal.tsx
autonomous: false

must_haves:
  truths:
    - "User sees Google and GitHub OAuth buttons on the login modal"
    - "User sees Google and GitHub OAuth buttons on the signup modal"
    - "Clicking an OAuth button initiates the OAuth flow (opens external browser)"
    - "OAuth buttons show loading state while flow is in progress"
    - "User can clearly distinguish between OAuth and email login options"
  artifacts:
    - path: "frontend/src/components/auth/LoginModal.tsx"
      provides: "Google and GitHub OAuth buttons above email form with divider"
      contains: "signInWithOAuth"
    - path: "frontend/src/components/auth/SignupModal.tsx"
      provides: "Google and GitHub OAuth buttons above email form with divider"
      contains: "signInWithOAuth"
  key_links:
    - from: "frontend/src/components/auth/LoginModal.tsx"
      to: "frontend/src/stores/authStore.ts"
      via: "useAuthStore().signInWithOAuth('google'|'github')"
      pattern: "signInWithOAuth"
    - from: "frontend/src/components/auth/SignupModal.tsx"
      to: "frontend/src/stores/authStore.ts"
      via: "useAuthStore().signInWithOAuth('google'|'github')"
      pattern: "signInWithOAuth"
---

<objective>
Add Google and GitHub OAuth buttons to the login and signup modals, with visual divider and loading states. Then verify the complete OAuth flow works end-to-end, including error scenarios.

Purpose: Users need visible, clickable OAuth options to use Google/GitHub login. This completes the user-facing side of Phase 5.

Output: Updated LoginModal and SignupModal with OAuth buttons, plus human verification of the flow.
</objective>

<execution_context>
@/Users/damifiance/.claude/get-shit-done/workflows/execute-plan.md
@/Users/damifiance/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-oauth-integration/05-01-SUMMARY.md
@frontend/src/components/auth/LoginModal.tsx
@frontend/src/components/auth/SignupModal.tsx
@frontend/src/stores/authStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add OAuth buttons to LoginModal and SignupModal</name>
  <files>frontend/src/components/auth/LoginModal.tsx, frontend/src/components/auth/SignupModal.tsx</files>
  <action>
**Both LoginModal.tsx and SignupModal.tsx** — Add OAuth buttons section ABOVE the email/password form:

1. Import `signInWithOAuth` from the authStore (add to existing useAuthStore destructure).

2. Add two OAuth buttons at the top of the form content (before error display and email field):

   **Google button:**
   - White background, gray border, rounded-xl, full width
   - Google "G" logo as inline SVG (the standard 4-color G logo, ~18px)
   - Text: "Continue with Google"
   - onClick: `() => signInWithOAuth('google')`
   - disabled when isLoading

   **GitHub button:**
   - Dark gray/black background (#24292e), white text, rounded-xl, full width
   - GitHub octocat SVG icon (~18px)
   - Text: "Continue with GitHub"
   - onClick: `() => signInWithOAuth('github')`
   - disabled when isLoading

3. Add a visual divider between OAuth buttons and email form:
   ```
   <div className="flex items-center gap-3 my-5">
     <div className="flex-1 h-px bg-gray-200" />
     <span className="text-xs text-gray-400">or</span>
     <div className="flex-1 h-px bg-gray-200" />
   </div>
   ```

4. Both buttons should show the same Loader2 spinner when `isLoading` is true (reuse existing pattern from the submit button).

5. Style the buttons to match the existing modal design language: rounded-xl, py-3, text-sm font-medium, flex items-center justify-center gap-3, transition-all, hover states.

**LoginModal.tsx specific:** OAuth buttons appear above the "or" divider, then email form below. Header stays "Sign In".

**SignupModal.tsx specific:** Same layout as LoginModal. Header stays "Create Account". OAuth buttons text should say "Continue with Google/GitHub" (not "Sign up with") since OAuth does both sign up and sign in.

Do NOT add `lucide-react` icons for Google/GitHub — use inline SVGs for brand accuracy. The Google "G" must be the 4-color version. The GitHub icon must be the octocat silhouette.
  </action>
  <verify>
Run `cd /Users/damifiance/workspace/AI-paper-reader/frontend && npx tsc --noEmit` to verify no TypeScript errors. Run `cd /Users/damifiance/workspace/AI-paper-reader/frontend && npm run build` to verify the build succeeds.
  </verify>
  <done>
LoginModal and SignupModal both show Google and GitHub OAuth buttons above the email/password form, separated by an "or" divider. Buttons call signInWithOAuth with correct provider. Loading states work. Build passes.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify OAuth flow end-to-end including error scenarios</name>
  <files>frontend/src/components/auth/LoginModal.tsx, frontend/src/components/auth/SignupModal.tsx</files>
  <action>
CHECKPOINT: Human verification of OAuth UI and flow.

What was built: Complete OAuth integration including Electron protocol handler (lumenai://), deep link handling, OAuth buttons in login/signup modals, and Supabase PKCE exchange.

How to verify:

**Visual and functional verification:**
1. Start the app in dev mode (`npm run dev` in frontend, backend optional)
2. Open the Sign In modal — verify you see "Continue with Google" and "Continue with GitHub" buttons above an "or" divider, then the email/password form below
3. Open the Sign Up modal — verify same OAuth buttons appear
4. Verify the OAuth buttons and email/password form are clearly visually distinct (divider, spacing, different button styles)
5. Click "Continue with Google" — verify:
   a. Your default browser opens to Google's OAuth consent screen (via Supabase)
   b. The button shows a loading state
6. Visual check: OAuth buttons match the modal's design language (rounded corners, proper spacing, brand-accurate icons)

**Error scenario verification:**
7. If Supabase providers are NOT configured: clicking an OAuth button should open the browser to a Supabase error page — this confirms the flow reaches Supabase. The app should NOT crash or hang.
8. Close the browser tab without completing OAuth (simulating user denial) — verify the app returns to normal state, no infinite spinner. The loading state should clear or be clearable.
9. Check the error display: if `authStore.error` is set from a failed OAuth attempt, verify the error message is shown in the modal (not silently swallowed).

**Full end-to-end testing (if providers configured):**
10. Complete a Google OAuth login — verify you are logged in after the browser redirects back
11. Complete a GitHub OAuth login — verify same
12. Verify tokens persist across page refresh (sign in, refresh, still signed in)

Note: Full callback redirect requires either a packaged build (for lumenai:// protocol on macOS/Linux) or running on Windows in dev mode. If testing in dev mode on macOS/Linux, steps 10-12 may not be testable yet — that is expected.

Resume signal: Type "approved" if the OAuth buttons render correctly, clicking them opens the external browser, and error scenarios behave reasonably. Describe any issues otherwise.
  </action>
  <verify>User confirms OAuth buttons render correctly, clicking them opens external browser, and error handling is reasonable.</verify>
  <done>User has verified OAuth UI appearance, flow initiation, and error handling behavior.</done>
</task>

</tasks>

<verification>
1. LoginModal renders Google and GitHub OAuth buttons with brand-accurate SVG icons
2. SignupModal renders Google and GitHub OAuth buttons with brand-accurate SVG icons
3. Both modals have "or" divider between OAuth and email sections — clearly distinguishing the two options
4. Clicking OAuth button calls signInWithOAuth which opens external browser
5. Error scenarios handled: unconfigured provider shows Supabase error page (no crash), user cancellation does not leave app in broken state
6. TypeScript compiles, build succeeds
</verification>

<success_criteria>
- Google and GitHub OAuth buttons visible in both login and signup modals
- Buttons use brand-accurate SVG icons (4-color Google G, GitHub octocat)
- User can clearly distinguish between OAuth and email login options (visual divider + distinct styling)
- Clicking button initiates OAuth flow (opens external browser to provider)
- Loading states display correctly during OAuth flow
- Error scenarios behave reasonably (no crashes, no infinite spinners, errors displayed)
- Overall modal design remains cohesive and polished
</success_criteria>

<output>
After completion, create `.planning/phases/05-oauth-integration/05-02-SUMMARY.md`
</output>
